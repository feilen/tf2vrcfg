// ----------------------------------------------------------------------------
// ---------------------Feilen's TF2 Highquality Script------------------------
// 
//   Heavily modified based off of Chris' FPS configs Highquality script. 
//  Intended to give a very high quality VR experience, only sacrificing  
//  features that don't look good in VR.
//  Note: If you've used highframes or other Chris' FPS configs in the past,
//  (or even the lowquality config here) you may need to reset your config.cfg
//  to avoid graphical glitches.
// ----------------------------------------------------------------------------
// Reccomended launch options: -novid -h 1080 -w 1920 -freq 75 -full
// ----------------------------------------------------------------------------

// ----------------------------------------------------------------------------
// Option Groups (keep in this order)
// ----------------------------------------------------------------------------
// use_dk2, use_dk1: Set detail distance to optimize for stereo vision.
// gfx_highquality, gfx_lowquality: Bulk graphical configs
// netset_good, netset_bad: Network settings for good or bad networks.
// -x--aa: Antialiasing settings, see below for options.
// 
// 
// ----------------------------------------------------------------------------

alias tf2vrcfg "use_dk2; netset_good; 16xqcsaa"

// ----------------------------------------------------------------------------
// Graphical
// ----------------------------------------------------------------------------

// Low quality config
alias gfx_lowquality="cl_playerspraydisable 0;r_spray_lifetime 2;mat_shadowstate 1;r_shadowmaxrendered 11;r_shadowrendertotexture 1; gfx_lq1"
alias gfx_lq1="r_eyes 1;r_flex 1;r_lod 1 ;r_rootlod 1;r_teeth 1;cl_ragdoll_fade_time 15;cl_ragdoll_forcefade 0;cl_ragdoll_physics_enable 1; gfx_lq2"
alias gfx_lq2="g_ragdoll_fadespeed 600;g_ragdoll_lvfadespeed 100;ragdoll_sleepaftertime "5.0f";cl_phys_props_enable 1;cl_phys_props_max 128; gfx_lq3"
alias gfx_lq3="props_break_max_pieces -1;r_propsmaxdist 1000;violence_agibs 1;violence_hgibs 1;cl_drawmonitors 0;cl_ejectbrass 0; gfx_lq4"
alias gfx_lq4="cl_jiggle_bone_framerate_cutoff 0 ;cl_new_impact_effects 0;cl_show_splashes 0;func_break_max_pieces 0;lod_transitiondist 0; gfx_lq5"
alias gfx_lq5="mat_colcorrection_disableentities 1;mat_colorcorrection 0;mat_disable_fancy_blending 1;mat_disable_lightwarp 1;mat_envmapsize 8; gfx_lq6"
alias gfx_lq6="mat_envmaptgasize 8;mat_filterlightmaps 1;mat_filtertextures 1;mat_max_worldmesh_vertices 512;mat_parallaxmap 0;mat_reducefillrate 1; gfx_lq7"
alias gfx_lq7="mat_reduceparticles 1;mat_specular 1 ;mat_trilinear 1;mat_viewportscale 1 ;mat_viewportupscale 1;mp_decals 9 ;r_3dsky 0;r_avglight 0; gfx_lq8"
alias gfx_lq8="r_decals 9;r_decalstaticprops 0;r_decal_cullsize 15;r_drawdetailprops 0;r_drawmodeldecals 0;r_drawflecks 0;r_dynamic 0; gfx_lq9"
alias gfx_lq9="r_flashlightdepthtexture 0;r_lightaverage 0;r_maxnewsamples 2;r_maxsampledist 1;r_propsmaxdist 0;r_renderoverlayfragment 0; gfx_lq10"
alias gfx_lq10="r_staticprop_lod 4;rope_averagelight 0;rope_collide 0;rope_rendersolid 0;rope_shake 0;rope_smooth 0;rope_subdiv 0;rope_wind_dist 0; gfx_lq11"
alias gfx_lq11="tf_particles_disable_weather 1 ;tracer_extra 0;violence_ablood 1 ;violence_hblood 1"

// High quality config
alias gfx_highquality="cl_burninggibs 1;cl_maxrenderable_dist 4096;cl_new_impact_effects 1;cl_phys_props_max 1024;cl_ragdoll_collide 1; gfx_hq1"
alias gfx_hq1="lod_transitiondist 6400;mat_compressedtextures 1;mat_envmapsize 256;mat_envmaptgasize 256;mat_parallaxmap 1;mat_postprocess_x 8; gfx_hq2"
alias gfx_hq2="mat_postprocess_y 8;mat_reducefillrate 0;mat_software_aa_blur_one_pixel_lines 0.5;mat_software_aa_edge_threshold 0.8; gfx_hq3"
alias gfx_hq3="mat_software_aa_quality 2;mat_software_aa_strength 2;mat_software_aa_strength_vgui 2;mat_specular 1;mp_decals 512;mp_usehwmmodels 1; gfx_hq4"
alias gfx_hq4="mp_usehwmvcds 1;r_avglight 3;r_decals 512;r_eyeglintlodpixels 8;r_lod 0;r_maxmodeldecal 512;r_radiosity 1;r_rainsplashpercentage 100; gfx_hq5"
alias gfx_hq5="r_rootlod 0;r_shadowmaxrendered 1024;r_shadowrendertotexture 1"

// Antialiasing
alias noaa "mat_antialias 1; mat_aaquality 0"
alias 2xfsaa "mat_antialias 2; mat_aaquality 0"
alias 4xfsaa "mat_antialias 4; mat_aaquality 0"
alias 8xcsaa "mat_antialias 4; mat_aaquality 2"
alias 16xcsaa "mat_antialias 4; mat_aaquality 4"
alias 8xmsaa "mat_antialias 8; mat_aaquality 0"
alias 16xqcsaa "mat_antialias 8; mat_aaquality 2"

// Antistropic Filtering
mat_forceaniso 16

// All
cl_detailfade 0
fps_max 0
in_usekeyboardsampletime 0
mat_clipz 1
mat_forcehardwaresync 0
mat_levelflush 1
mat_vsync 0
r_fastzreject -1
r_shadows 1

// ----------------------------------------------------------------------------
// VR Enhancement
// ----------------------------------------------------------------------------

// Eye distance rendering, don't render detail beyond what's stereoscopic
// DK1 = ( (IPD=68mm) / tan ( 86 degrees / (1280px / 2) )) * 16 
// DK2 = ( (IPD=68mm) / tan ( 84 degrees / (1920px / 2) )) * 16 
// IPD=68mm will cover 95% of men in the US, and a higher percentage of women.
// Use a rough estimate for degrees/px, as cl_detailfade will cover the rest.
// This value gets reset on map change, so we need to put it into char.cfg

// DK2
alias use_dk2 "alias set_rift_detaildist cl_detaildist 2338"

// DK1
alias use_dk1 "alias set_rift_detaildist cl_detaildist 1520"

// Disable water, doesn't look good
r_waterdrawreflection 0
r_waterforceexpensive 0
r_waterforcereflectentities 0
mat_wateroverlaysize 1
r_cheapwaterend 1
r_cheapwaterstart 1

// Disable HDR, eyes don't work that way
mat_hdr_level 0
mat_disable_bloom 1
r_ambientboost 0
r_ambientfactor 0
r_ambientmin 0

// Rift is sRGB calibrated, so gamma = 2.2
mat_monitorgamma 2.2

// By default, you only get 10% tracking volume. This fixes that
vr_translation_limit 100

// ----------------------------------------------------------------------------
// Net settings, for good connections.
// ----------------------------------------------------------------------------

alias netset_good "cl_cmdrate 66;cl_interp 0.03;cl_interp_ratio 1;cl_lagcompensation 1;cl_pred_optimize 2;cl_smooth 1;cl_smoothtime 0.03;cl_updaterate 66;rate 60000"
alias netset_bad  "cl_cmdrate 40;cl_interp 0.03;cl_interp_ratio 1;cl_lagcompensation 1;cl_pred_optimize 2;cl_smooth 1;cl_smoothtime 0.06;cl_updaterate 40;rate 35000"

// ----------------------------------------------------------------------------
// Sound
// ----------------------------------------------------------------------------
dsp_enhance_stereo 1
dsp_slow_cpu 0
snd_async_fullyasync 1
snd_pitchquality 1

// ----------------------------------------------------------------------------
// Threading 
// ----------------------------------------------------------------------------
mat_queue_mode 2
r_threaded_client_shadow_manager 1
r_threaded_particles 1
r_threaded_renderables 1
cl_threaded_client_leaf_system 0
r_queued_post_processing 0

// Possible problems, appears to cause crashes on linux when VR enabled
//cl_threaded_bone_setup 1
//r_queued_decals 1
//r_queued_ropes 1

// ----------------------------------------------------------------------------
// Custom
// ----------------------------------------------------------------------------
glow_outline_effect_enable 0 // Set to 1 to have objectives outlined

tf2vrcfg
